function getQueryParams(e){var t=window.location.href,a=e.replace(/[\[\]]/g,"\\$&"),o=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),s=o.exec(t);return s?s[2]?void("task"===e?window.workbert.taskId=decodeURIComponent(s[2].replace(/\+/g," ")):"invite"===e&&(window.workbert.inviteId=decodeURIComponent(s[2].replace(/\+/g," ")))):"":null}function resizeSlider(){var e=$(window).height(),t=$(".page-slider_body");console.log("resize me"),console.log(e),t.height(e-116)}function handleTaskProgress(){var e=$(".hero__task-details"),t=$(".-task-pending",e),a=$(".-task-accepted",e);$(".hero__task-details--progress",e);"pending"===window.workbert.taskState?(a.hide(),t.show()):(a.show(),t.hide())}window.workbert={taskState:"pending",tasksDone:1,tasksTotal:4,progress:"25%",taskId:null,inviteId:null},$.fn.handleModal=function(){function e(e){"accepted"===e?(window.workbert.taskState="accepted",handleTaskProgress(),k.addClass("section-accepted"),k.removeClass("section-pending"),$(".body-content_bullet",a).each(function(e,t){console.log(t),$(this).addClass("-indent"),$(".radio-button",$(this)).fadeIn()}),b.hide(),_.show(),v.html("TASK IN PROGRESS")):"completed"===e&&(window.workbert.taskState="completed",handleTaskProgress(),k.addClass("section-completed"),k.removeClass("section-accepted"),g.addClass("button--completed"),$(".body-content_bullet",a).each(function(e,t){$(".radio-button",$(this)).addClass("-selected")}))}function t(e){console.log(e),$("#taskAvatar").attr("src",e.assigner.avatar_url),$("#taskOwner").html(e.assigner.name),$("#taskDueDate").html(e.due_date),$("#taskDescription").html(e.title),$.each(e.items,function(e,t){console.log(t),$("#taskContent").append('<div class="body-content_bullet"><div class="radio-button fa fa-check"></div>'+t.text+"</div>")}),$throbber.fadeOut(),m.removeClass("-is-open"),f.fadeOut(),w.show(),b.fadeIn(),a.removeClass("-lock")}var a=$(this),o=$(".page-slider--pin",a),s=$(".page-slider--accepted",a),n=$(".page-slider--progress",a),r=$("#ellroiFullName",a),i=$("#ellroiJobTitle",a),l=$("#ellroiPassword",a),d=$("#joinEllroi",a),c=$("#taskAccepted",a),p=$("#acceptTask",a),g=$("#finishTask",a),h=$(".page-slider_close-button",a),u=$("#updateTask",a),f=$(".page-overlay",a),m=$(".page-slider",a),k=$("#mainSection",a),v=$(".main-navigation__header",a),w=$("footer",a),b=$(".main-footer__container.-pending",a),_=$(".main-footer__container.-accepted",a);$throbber=$(".throbber-full",a),d.click(function(e){e.preventDefault(),$throbber.fadeIn(),localStorage.setItem("ellroiAuth","bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ODgxMTMwYTM4N2U5ODBmNDhjNzQzZjcifQ.PPFE_iGoi_UGKdETnOv6teeOPmJeUsGWK0lK_fwIPSg"),$.ajax({url:"http://localhost:3000/api/v1/tasks/"+window.workbert.taskId,headers:{Authorization:localStorage.getItem("ellroiAuth")},success:function(e){r.val(""),i.val(""),l.val(""),t(e.task)},error:function(e){alert("Sorry. Something went wrong"),$throbber.fadeOut()}})}),p.click(function(e){e.preventDefault(),window.scrollTo(0,0),w.hide(),o.hide(),s.show(),m.addClass("-is-open"),f.fadeIn(),a.addClass("-lock")}),u.click(function(e){e.preventDefault(),window.scrollTo(0,0),w.hide(),o.hide(),s.hide(),n.show(),n.show(),m.addClass("-is-open"),f.fadeIn(),a.addClass("-lock")}),h.click(function(e){e.preventDefault(),w.show(),m.removeClass("-is-open"),n.hide(),f.fadeOut(),a.removeClass("-lock")}),c.click(function(t){t.preventDefault(),w.show(),e("accepted"),m.removeClass("-is-open"),f.fadeOut(),a.removeClass("-lock")}),g.click(function(t){t.preventDefault(),e("completed")})},$.fn.handleSliderProgress=function(){var e=$(this),t=$(".percentage",e),a=$(".page-slider_radial-controls_button.-increase",e),o=$(".page-slider_radial-controls_button.-decrease",e),s=$(".progress-radial",e);console.log(e),console.log(t),console.log(a),console.log(o),console.log(s),a.click(function(e){e.preventDefault();var a=s.attr("data-progress"),o=parseInt(a,10);o<100&&(o+=25,o>99?s.attr("data-progress","100"):s.attr("data-progress",o),t.html(s.attr("data-progress")+"%"))}),o.click(function(e){e.preventDefault();var a=s.attr("data-progress"),o=parseInt(a,10);o>0&&(o-=25,o<1?s.attr("data-progress","0"):s.attr("data-progress",o),t.html(s.attr("data-progress")+"%"))})},$.fn.handleComments=function(){function e(){var e=a.val();o.prepend('<div class="comment-item"><div class="comment-item_heading">Sent: Just now</div><div class="comment-item_text">'+e+"</div></div>"),a.val("")}var t=$(this),a=$(".page-slider_textarea",t),o=$(".comment-item_list",t);console.log(t),console.log(a),console.log(o),a.keyup(function(t){13===(t.keyCode||t.which)&&e()})},$(function(){getQueryParams("task"),getQueryParams("invite"),$("#pending-page").handleModal(),$("#radialProgress").handleSliderProgress(),$("#sliderComments").handleComments(),resizeSlider(),handleTaskProgress()}),window.addEventListener("resize",resizeSlider);